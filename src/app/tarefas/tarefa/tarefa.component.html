<div class="container main-container">
  <h4>To-Do List - A melhor maneira de fazer acontecer!</h4>
  <hr>

  <form novalidate [formGroup]="tarefaForm">

    <!--Primeira linha-->
    <div class="form-row">

      <div class="form-group col-md-6">
        <label for="titulo">Título</label>  
        <input class="form-control" id="titulo" type="text" placeholder="Título (requerido)" formControlName="titulo">
        <span class="text-danger" *ngIf="tarefaForm.get('titulo').errors && (tarefaForm.get('titulo').dirty || tarefaForm.get('titulo').touched)">
          <p>Preencha o campo título</p>
        </span>
      </div>

      <div class="form-group col-md-6">
        <label for="descricao">Descrição</label>
          <input class="form-control" id="descricao" type="text" placeholder="Descrição (requerido)"
            formControlName="descricao">
          <span class="text-danger" *ngIf="tarefaForm.get('descricao').errors && (tarefaForm.get('descricao').dirty || tarefaForm.get('descricao').touched)">
            <p>Preencha o campo descrição</p>
          </span>
      </div>
    </div>
    <!--Fim primeira linha-->

    <!--Segunda linha-->
    <div class="form-row">

      <div class="form-group col-md-6">
        <label>Categoria</label><br>
        <select class="custom-select" formControlName="categoria">
          <option value="Facil">Fácil</option>
          <option value="Dificil">Difícil</option>
          <option value="Urgente">Urgente</option>
          <option value="Prioritaria">Prioritária</option>
        </select>
        <span class="text-danger" *ngIf="tarefaForm.get('categoria').errors && (tarefaForm.get('categoria').dirty || tarefaForm.get('categoria').touched)">
          <p>Selecione uma das categorias acima</p>
        </span>
      </div>

      <div class="form-group col-md-6">
        <label>Data de conclusão</label>
        <input class="form-control" id="data" type="datetime-local" formControlName="dataConclusao">
        <span class="text-danger" *ngIf="tarefaForm.get('dataConclusao').errors && (tarefaForm.get('dataConclusao').dirty || tarefaForm.get('dataConclusao').touched)">
          <p>Preencha o campo data de conclusão</p>
        </span>
      </div>

    </div>
    <!--Fim da segunda linha-->

      <div class="form-group">
        <label>Tarefa concluída?</label>
        <div class="form-check">
          <input class="form-check-input" type="checkbox" formControlName="finalizado">
          <label class="form-check-label" for="flexCheckChecked">Concluída</label>
        </div>
      </div><hr>

      <div class="form-group" style="text-align: center;">
          <button class="btn btn-success" id="Registrar" type="submit" (click)="guardaTarefa()" [disabled]="!tarefaForm.valid">Registrar</button>&nbsp;
          <button class="btn btn-primary" id="Limpar" type="reset">Limpar</button>
      </div><hr>

      <div class="form-group">
        <p>Formulário válido: {{tarefaForm.valid}}</p>
        <p>Formulário tocado: {{tarefaForm.touched}}</p>
        <p>Formulário sujo: {{tarefaForm.dirty}}</p><br>
        <p>Formulário: {{formResult}}</p>
      </div>

  </form>

  <div class="table-responsive">

    <table class="table table-hover table-striped">
      <thead>
        <td></td>
        <td>#</td>
        <td>Título</td>
        <td>Descrição</td>
        <td>Finalizado?</td>
        <td>Categoria</td>
        <td>Data de conclusão</td>
        <td></td>
      </thead>
  
      <tbody>
        <tr *ngFor="let tarefa of tarefas">
          <td>
            <button class="text-white btn btn-sm btn-secondary" (click)="atualizarTarefa(tarefa)">Editar</button>
          </td>
          <td>{{tarefa.id}}</td>
          <td>{{tarefa.titulo | titlecase}}</td>
          <td>{{tarefa.descricao}}</td>
          <td>{{tarefa.finalizado}}</td>
          <td>{{tarefa.categoria}}</td>
          <td>{{tarefa.dataConclusao | date: 'dd/MM/yyy, hh:mm'}}</td>
          <td>
            <div class="btn-group">
              <button class="btn btn-sm btn-danger" (click)="removeTarefa(tarefa)">Excluir</button>
            </div>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

</div>
